import{V as a,a as w,h as o}from"./vendor-c144a7d7.min.js";import{r as h,g as c}from"./monsterinsights-helper-plugin-d729472b.min.js";const{__:y,sprintf:D}=wp.i18n,$=(t,e,s,n)=>new Promise(r=>{let i=new FormData;i.append("action","monsterinsights_vue_get_report_data"),i.append("nonce",a.prototype.$mi.nonce),i.append("report",e),i.append("start",s),i.append("end",n),t.getters.date.compareReport&&(i.append("compare_report",!0),i.append("compare_end",t.getters.date.compareEnd),i.append("compare_start",t.getters.date.compareStart)),w.post(a.prototype.$mi.ajax,i).then(l=>{r(l.data)}).catch(async function(l){await h("report_fetch_error"),t.dispatch("$_app/block",!1,{root:!0});const f=a.prototype.$getUrl("admin-notices","error-verifying-license","https://www.monsterinsights.com/my-account/support");if(l.response){const u=l.response;return a.prototype.$mi_error_toast({title:D(y("Can't load report data. Error: %1$s, %2$s. Please try again in a few minutes. If the issue persists, please %3$scontact our support%4$s team.","google-analytics-for-wordpress"),u.status,u.statusText,'<a target="_blank" href="'+f+'">',"</a>")})}a.prototype.$swal.hideLoading(),a.prototype.$mi_error_toast({allowOutsideClick:!0,allowEscapeKey:!0,title:y("Error loading report data","google-analytics-for-wordpress"),html:l.message})})}),b=t=>{if(typeof t<"u"){const e=parseInt(t.toString().replace(".",""),10);return e.toString().length===1?parseInt(e===1?e+"00":e+"0"):e}},L=t=>{if(typeof t<"u"){let e={};return Object.keys(t).forEach(function(s){let n=s.toString().split("-").join("_");e[n]=t[s]}),e}},R=t=>new Promise((e,s)=>{const n=new FormData;n.append("action","monsterinsights_vue_capture_last_used_report"),n.append("report",t),n.append("nonce",a.prototype.$mi.nonce),w.post(a.prototype.$mi.ajax,n).then(r=>{e(r.data)}).catch(async function(r){await h("report_capture_error"),s(r)})}),B=t=>new Promise(e=>{let s=new FormData;s.append("action","monsterinsights_vue_get_overview_bundle"),s.append("nonce",a.prototype.$mi.nonce),s.append("start",t.state.date.start),s.append("end",t.state.date.end),t.getters.date.compareReport&&(s.append("compare_report",!0),s.append("compare_end",t.getters.date.compareEnd),s.append("compare_start",t.getters.date.compareStart)),w.post(a.prototype.$mi.ajax,s).then(n=>{e(n.data)}).catch(async function(n){await h("overview_bundle_fetch_error"),t.dispatch("$_app/block",!1,{root:!0});const r=a.prototype.$getUrl("admin-notices","error-verifying-license","https://www.monsterinsights.com/my-account/support");if(n.response){const i=n.response;return a.prototype.$mi_error_toast({title:D(y("Can't load overview data. Error: %1$s, %2$s. Please try again in a few minutes. If the issue persists, please %3$scontact our support%4$s team.","google-analytics-for-wordpress"),i.status,i.statusText,'<a target="_blank" href="'+r+'">',"</a>")})}a.prototype.$swal.hideLoading(),a.prototype.$mi_error_toast({allowOutsideClick:!0,allowEscapeKey:!0,title:y("Error loading overview data","google-analytics-for-wordpress"),html:n.message})})}),E={fetchReportData:$,getFormattedScore:b,keysReplaceHyphensWithUnderscores:L,captureLastUsedReport:R,fetchOverviewBundle:B},{__:d,sprintf:g}=wp.i18n,S=(t,e)=>{const s=["overview","site_summary","yearinreview"];return!a.prototype.$isPro()&&!s.includes(e)?null:new Promise(n=>{if(!a.prototype.$mi.authed)return n(!1),t.commit("ENABLE_BLUR"),t.commit("ENABLE_NOAUTH"),!1;if(t.state.reload_report===!1&&t.state[e]&&t.state[e].reportcurrentrange&&!t.state.date.compareReport&&t.state[e].reportcurrentrange.startDate===t.state.date.start&&t.state[e].reportcurrentrange.endDate===t.state.date.end)return n(!1),t.commit("DISABLE_BLUR"),!1;a.prototype.$mi_loading_toast(),t.commit("ENABLE_BLUR"),t.dispatch("$_queue/add",()=>E.fetchReportData(t,e,t.state.date.start,t.state.date.end).then(function(r){if(t.commit("SET_IS_LOADED"),r.data.message==="license_level"){p(t),n(!1);return}if(r.success)p(t),t.commit("DISABLE_BLUR"),t.commit("UPDATE_REPORT_DATA",{report:e,data:r.data}),n(!0);else{if(r.data.message==="invalid_grant"){p(t),n(!1),t.commit("ENABLE_REAUTH");return}if(r.data.footer&&r.data.footer==="install_addon"){let i=t.state.required_addon?t.state.required_addon:e;O(t,i).then(function(l){t.rootState.$_widget&&(t.commit("DISABLE_BLUR"),t.commit("$_widget/UPDATE_LOADED",!0,{root:!0}));let f=d(l?"activate":"install","google-analytics-for-wordpress");a.prototype.$mi_error_toast({title:!1,html:g(r.data.message,f),footer:'<a href="'+a.prototype.$mi.addons_url+'">'+d("Visit addons page","google-analytics-for-wordpress")+"</a>",report:e}),a.prototype.$swal({icon:"error",customClass:{container:"monsterinsights-swal"},title:d("Report Unavailable","google-analytics-for-wordpress"),html:g(r.data.message,f),allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!1,showCancelButton:!0,confirmButtonText:g(d("%s Addon","google-analytics-for-wordpress"),f.charAt(0).toUpperCase()+f.slice(1)),cancelButtonText:d("Dismiss","google-analytics-for-wordpress")}).then(function(u){u.value&&(l?v(t,t.rootState.$_addons.addons[i]):T(t,i))})})}else r.data.footer&&r.data.footer.indexOf("#/ecommerce")>0?(n(!1),a.prototype.$mi_error_toast({title:!1,html:r.data.message,report:e,showCancelButton:!0,cancelButtonText:d("Go Back To Reports","google-analytics-for-wordpress"),confirmButtonText:d("Enable Enhanced eCommerce","google-analytics-for-wordpress")}).then(function(i){i.value&&(window.location=r.data.footer)})):r.data.type&&r.data.type==="expired_license"?(n(!1),a.prototype.$mi_error_toast({type:"",customClass:{container:"monsterinsights-expired-license-alert-toast"},confirmButtonText:"",title:!1,html:r.data.message,footer:r.data.footer,report:e})):(n(!1),a.prototype.$mi_error_toast({title:!1,html:r.data.message,footer:r.data.footer,report:e,onClose:()=>{if(!r.data.type||r.data.type!=="INVALID_DATE_RANGE"||t.state.date==="last30days")return;const i=a.prototype.$mi_intervals().last30days;t.commit("UPDATE_INTERVAL","last30days"),t.commit("UPDATE_DATE",{start:i.start.format("YYYY-MM-DD"),end:i.end.format("YYYY-MM-DD")}),t.dispatch("getReportData",t.state.activeReport)}}))}}),{root:!0})})};function O(t,e){return new Promise(function(s){t.dispatch("$_addons/getAddons","",{root:!0}).then(function(){t.rootState.$_addons.addons[e]&&t.rootState.$_addons.addons[e].installed?s(!0):s(!1)}).catch(function(){s(!1),A()})})}function T(t,e){a.prototype.$swal({icon:"info",customClass:{container:"monsterinsights-swal"},title:d("Installing Addon","google-analytics-for-wordpress"),html:d("Please wait","google-analytics-for-wordpress"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading(),t.dispatch("$_addons/installAddon",t.rootState.$_addons.addons[e],{root:!0}).then(function(){v(t,t.rootState.$_addons.addons[e])}).catch(function(){A()})}})}function v(t,e){a.prototype.$swal({icon:"info",customClass:{container:"monsterinsights-swal"},title:d("Activating Addon","google-analytics-for-wordpress"),html:d("Please wait","google-analytics-for-wordpress"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading()}}),t.dispatch("$_addons/activateAddon",e,{root:!0}).then(function(){a.prototype.$swal({icon:"info",customClass:{container:"monsterinsights-swal"},title:d("Addon Activated","google-analytics-for-wordpress"),html:d("Loading report data","google-analytics-for-wordpress"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading(),setTimeout(function(){window.location.reload()},1e3)}})}).catch(function(s){A(s)})}function A(t){let e=d("Please activate manually","google-analytics-for-wordpress");t.response&&(e=g(d("Error: %1$s, %2$s","google-analytics-for-wordpress"),t.response.status,t.response.statusText)),a.prototype.$swal({icon:"error",customClass:{container:"monsterinsights-swal"},title:d("Error Activating Addon","google-analytics-for-wordpress"),html:e,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,showCancelButton:!0,confirmButtonText:d("View Addons","google-analytics-for-wordpress"),cancelButtonText:d("Dismiss","google-analytics-for-wordpress")}).then(function(s){s.value&&(window.location=a.prototype.$mi.addons_url,a.prototype.$swal({icon:"info",customClass:{container:"monsterinsights-swal"},title:d("Redirecting","google-analytics-for-wordpress"),html:d("Please wait","google-analytics-for-wordpress"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading()}}))})}function p(t){t.rootState.$_widget||typeof a.prototype.$swal=="function"&&a.prototype.$swal.close()}const U=(t,e)=>{E.captureLastUsedReport(e)},P=t=>new Promise(e=>{if(!a.prototype.$mi.authed)return e(!1),t.commit("ENABLE_BLUR"),t.commit("ENABLE_NOAUTH"),!1;const s=t.state.reload_report===!1&&t.state.overview&&t.state.overview.reportcurrentrange&&!t.state.date.compareReport,n=t.state.site_summary&&t.state.site_summary.reportcurrentrange;if(s&&n){const r=t.state.overview.reportcurrentrange.startDate===t.state.date.start&&t.state.overview.reportcurrentrange.endDate===t.state.date.end,i=t.state.site_summary.reportcurrentrange.startDate===t.state.date.start&&t.state.site_summary.reportcurrentrange.endDate===t.state.date.end;if(r&&i)return e(!1),t.commit("DISABLE_BLUR"),!1}a.prototype.$mi_loading_toast(),t.commit("ENABLE_BLUR"),t.dispatch("$_queue/add",()=>E.fetchOverviewBundle(t).then(function(r){if(t.commit("SET_IS_LOADED"),r.data.message==="license_level"){p(t),e(!1);return}if(r.success&&r.data)p(t),t.commit("DISABLE_BLUR"),r.data.overview&&t.commit("UPDATE_REPORT_DATA",{report:"overview",data:r.data.overview}),r.data.site_summary&&t.commit("UPDATE_REPORT_DATA",{report:"site_summary",data:r.data.site_summary}),r.data.user_metrics&&t.commit("$_settings/UPDATE_INCLUDED_METRICS",r.data.user_metrics,{root:!0}),e(!0);else{if(r.data.message==="invalid_grant"){p(t),e(!1),t.commit("ENABLE_REAUTH");return}e(!1),a.prototype.$mi_error_toast({title:!1,html:r.data.message,footer:r.data.footer,report:"overview"})}}),{root:!0})}),C={getReportData:S,installAddon:T,activateAddon:v,captureLastUsedReport:U,getOverviewBundle:P,maybeCloseSwal:p},I=t=>t.yearinreview_data,Y=t=>t.activeReport,k=t=>t.isLoaded,N=t=>t.blur,M=t=>t.mobileTableExpanded,K=t=>t.overview,q=t=>t.site_summary,V=t=>t.publisher,H=t=>t.ecommerce,F=t=>t.ecommerce_coupons,j=t=>t.ecommerce_funnel,G=t=>t.cart_abandonment,W=t=>t.ecommerce_product_feed,X=t=>t.queries,Q=t=>t.dimensions,z=t=>t.forms,J=t=>t.realtime,Z=t=>t.yearinreview,x=t=>t.sitespeed,tt=t=>t.sitespeedmobile,et=t=>t.noauth,at=t=>t.reauth,rt=t=>t.media,ot=t=>t.countries,st=t=>t.traffic_overview,nt=t=>t.traffic_landing_pages,it=t=>t.traffic_technology,ct=t=>t.traffic_campaign,dt=t=>t.traffic_source_medium,lt=t=>t.traffic_social,mt=t=>t.traffic_ai,pt=t=>t.engagement_pages,ft=t=>t.custom_events,ut=()=>c("overview"),_t=()=>c("ecommerce"),gt=()=>c("ecommerce_coupons"),yt=()=>c("cart_abandonment"),wt=()=>c("dimensions"),ht=()=>c("countries"),Et=()=>c("traffic_overview"),vt=()=>c("traffic_technology"),At=()=>c("traffic_landing_pages"),Dt=()=>c("traffic_campaign"),Tt=()=>c("traffic_source_medium"),$t=()=>c("traffic_social"),bt=()=>c("traffic_ai"),Lt=()=>c("publisher"),Rt=()=>c("engagement_pages"),Bt=()=>c("queries"),St=()=>c("forms"),Ot=()=>c("realtime"),Ut=()=>c("sitespeed"),Pt=()=>c("media"),Ct=()=>c("ecommerce_funnel"),It=()=>c("ecommerce_product_feed"),Yt=()=>c("custom_events");function _(t,e){return t.format("YYYYMMDD")===e.format("YYYYMMDD")?t.format("MMM D, YYYY"):t.format("MMM D")+" - "+e.format("MMM D, YYYY")}function kt(t){let e=t.date,s=a.prototype.$mi_intervals();if(s[e.interval]){let n=s[e.interval];e.intervalText=_(n.start,n.end),e.intervalCompareText=_(n.compareStart,n.compareEnd)}else e.intervalText=_(o(e.start),o(e.end)),e.intervalCompareText=_(o(e.compareStart),o(e.compareEnd));return e}const Nt={yearinreview_data:I,date:kt,activeReport:Y,isLoaded:k,blur:N,mobileTableExpanded:M,overview:K,publisher:V,ecommerce:H,ecommerce_coupons:F,ecommerce_funnel:j,cart_abandonment:G,ecommerce_product_feed:W,queries:X,dimensions:Q,forms:z,realtime:J,noauth:et,yearinreview:Z,reauth:at,sitespeed:x,sitespeedmobile:tt,site_summary:q,media:rt,countries:ot,traffic_overview:st,traffic_landing_pages:nt,traffic_technology:it,traffic_campaign:ct,traffic_source_medium:dt,traffic_social:lt,traffic_ai:mt,engagement_pages:pt,custom_events:ft,demo_overview:ut,demo_ecommerce:_t,demo_ecommerce_coupons:gt,demo_cart_abandonment:yt,demo_dimensions:wt,demo_countries:ht,demo_traffic_overview:Et,demo_traffic_technology:vt,demo_traffic_landing_pages:At,demo_traffic_campaign:Dt,demo_traffic_source_medium:Tt,demo_traffic_social:$t,demo_traffic_ai:bt,demo_publisher:Lt,demo_engagement_pages:Rt,demo_queries:Bt,demo_forms:St,demo_realtime:Ot,demo_sitespeed:Ut,demo_media:Pt,demo_ecommerce_funnel:Ct,demo_ecommerce_product_feed:It,demo_custom_events:Yt},Mt=(t,e)=>{e.report&&e.data&&t[e.report]&&a.set(t,e.report,e.data)},Kt=(t,e)=>{e.start&&e.end&&(a.set(t.date,"start",e.start),a.set(t.date,"end",e.end))},qt=(t,e)=>{a.set(t.date,"interval",e)},Vt=(t,e)=>{a.set(t.date,"text",e)},Ht=(t,e)=>{t.activeReport=e},Ft=t=>{t.isLoaded=!0},jt=t=>{t.blur=!0},Gt=t=>{t.blur=!1},Wt=t=>{t.mobileTableExpanded=!0},Xt=t=>{t.mobileTableExpanded=!1},Qt=t=>{t.noauth=!0},zt=t=>{t.reauth=!0},Jt=t=>{t.reload_report=!0},Zt=t=>{t.reload_report=!1},xt=(t,e)=>{t.required_addon=e},te=(t,e)=>{t.date={...t.date,...e}},ee={UPDATE_REPORT_DATA:Mt,UPDATE_DATE:Kt,UPDATE_ACTIVE_REPORT:Ht,UPDATE_INTERVAL:qt,UPDATE_DATE_TEXT:Vt,SET_IS_LOADED:Ft,ENABLE_BLUR:jt,DISABLE_BLUR:Gt,EXPAND_TABLES:Wt,CONTRACT_TABLES:Xt,ENABLE_NOAUTH:Qt,ENABLE_REAUTH:zt,UPDATE_REQUIRED_ADDON:xt,UPDATE_DATE_STORE:te,ENABLE_REPORT_RELOAD:Jt,DISABLE_REPORT_RELOAD:Zt},ae={yearinreview_data:window.monsterinsights.yearinreview,date:{start:"",end:"",interval:"last30days",text:"",compareText:"",compareReport:!1,compareStart:"",compareEnd:""},blur:!1,activeReport:"overview",mobileTableExpanded:!1,overview:{},site_summary:{},publisher:{},ecommerce:{},ecommerce_coupons:{},ecommerce_funnel:{funnel_table:{none:[]},funnel_chart:[]},cart_abandonment:{},queries:{},dimensions:{},forms:{},realtime:{},yearinreview:{},sitespeed:{},sitespeedmobile:{},noauth:!1,reauth:!1,isLoaded:!1,media:{line_chart_report:{},video_details_rows:[]},countries:{},traffic_overview:{},traffic_landing_pages:{},traffic_technology:{},traffic_campaign:{},traffic_source_medium:{},traffic_social:{sessions_chart:{}},traffic_ai:{sessions_chart:{},ai_table:[]},engagement_pages:{},required_addon:null,reload_report:!1,ecommerce_product_feed:{},custom_events:{sessions_chart:{}}},se={namespaced:!0,state:ae,actions:C,getters:Nt,mutations:ee},{__:m}=wp.i18n,ne={today:{text:m("Today","google-analytics-for-wordpress"),start:o(),end:o(),interval:"today",compareStart:o().subtract(1,"days"),compareEnd:o().subtract(1,"days")},yesterday:{text:m("Yesterday","google-analytics-for-wordpress"),start:o().subtract(1,"days"),end:o().subtract(1,"days"),interval:"yesterday",compareStart:o().subtract(2,"days"),compareEnd:o().subtract(2,"days")},lastweek:{text:m("Last Week","google-analytics-for-wordpress"),end:o().startOf("week"),start:o().startOf("week").subtract(6,"days"),interval:"lastweek",compareStart:o().startOf("week").subtract(13,"days"),compareEnd:o().startOf("week").subtract(7,"days")},lastmonth:{text:m("Last Month","google-analytics-for-wordpress"),end:o().startOf("month").subtract(1,"days"),start:o().startOf("month").subtract(1,"month"),interval:"lastmonth",compareStart:o().startOf("month").subtract(2,"month"),compareEnd:o().startOf("month").subtract(1,"month").subtract(1,"days")},last7days:{text:m("Last 7 days","google-analytics-for-wordpress"),end:o().subtract(1,"days"),start:o().subtract(7,"days"),interval:"last7days",compareStart:o().subtract(14,"days"),compareEnd:o().subtract(8,"days")},last30days:{text:m("Last 30 days","google-analytics-for-wordpress"),end:o().subtract(1,"days"),start:o().subtract(30,"days"),interval:"last30days",compareStart:o().subtract(60,"days"),compareEnd:o().subtract(31,"days")},last90days:{text:m("Last 90 days","google-analytics-for-wordpress"),end:o().subtract(1,"days"),start:o().subtract(90,"days"),interval:"last90days",compareStart:o().subtract(180,"days"),compareEnd:o().subtract(91,"days")}};export{ne as D,se as R,v as a,E as h,T as i};
